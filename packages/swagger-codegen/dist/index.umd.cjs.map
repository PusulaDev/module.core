{"version":3,"file":"index.umd.cjs","sources":["../src/generate.ts"],"sourcesContent":["import { generateApi, type GenerateApiOutput, type GenerateApiParams } from \"swagger-typescript-api\";\nimport path from \"path\";\nimport { fileURLToPath } from \"url\";\nimport fs from \"fs\";\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nconst generateIndex = (data: GenerateApiOutput, output: string) => {\n    const { files } = data;\n\n    const imports = files.map(({ name }) => `export * from \"./${name.replace(\".ts\", \"\")}\";`).join(\"\\n\");\n\n    fs.writeFile(path.join(output, \"index.ts\"), imports + \"\\n\", (err) => {\n        if (err) {\n            console.log(err);\n            process.exit(1);\n        } else {\n            console.log(\"Codes are generated \\n\");\n        }\n    });\n};\n\nconst generateModule = () => {\n    const moduleDirectory = path.resolve(process.cwd(), \"./src/module\");\n    const moduleContent =\n        `import { CoreModule, SessionStorageCache } from \"@pusula/module.core\";\n\nconst coreModule = new CoreModule({ key: \"CoreModule\" });\ncoreModule.register(SessionStorageCache, { key: \"SessionStorageCache\" });\nconst injectable = coreModule.createInjectable();\n\nexport { coreModule, injectable };`;\n\n    if (!fs.existsSync(moduleDirectory)){\n        fs.mkdirSync(moduleDirectory);\n    }\n\n    fs.writeFile(path.join(moduleDirectory, \"index.ts\"), moduleContent, (err) => {\n        if (err) {\n            console.log(err);\n            process.exit(1);\n        } else {\n            console.log(\"module generated \\n\");\n            process.exit();\n        }\n    });\n};\n\nexport const generate = async (options: GenerateApiParams) => {\n    const defaultOutput = path.resolve(process.cwd(), \"./src/__generated__\");\n    const defaultTemplates = path.resolve(__dirname, \"../src/templates\");\n\n    options.output = options.output || defaultOutput;\n    options.templates = options.templates || defaultTemplates;\n    options.name = options.name || \"api.ts\";\n\n    try {\n        const generateResult = await generateApi({\n            httpClientType: \"fetch\",\n            generateClient: true,\n            generateResponses: true,\n            moduleNameIndex: 1,\n            singleHttpClient: true,\n            cleanOutput: true,\n            sortTypes: true,\n            extractEnums: true,\n            extractRequestParams: true,\n            modular: true,\n            moduleNameFirstTag: true,\n            ...options\n        });\n\n        generateIndex(generateResult, options.output);\n        generateModule()\n    } catch (e) {\n        console.error(e);\n        process.exit(1);\n    }\n};\n"],"names":["__filename","fileURLToPath","__dirname","path","generateIndex","data","output","files","imports","name","fs","err","generateModule","moduleDirectory","moduleContent","generate","options","defaultOutput","defaultTemplates","generateResult","generateApi","e"],"mappings":"wYAKA,MAAMA,EAAaC,EAAAA,cAAc,OAAA,SAAA,KAAA,OAAA,SAAA,IAAA,IAAA,QAAA,KAAA,GAAA,IAAA,QAAAD,CAAA,EAAA,KAAA,OAAA,SAAA,IAAA,SAAA,KAAA,SAAA,eAAA,SAAA,cAAA,KAAA,IAAA,IAAA,gBAAA,SAAA,OAAA,EAAA,IAAe,EAC1CE,EAAYC,EAAK,QAAQH,CAAU,EAEnCI,EAAgB,CAACC,EAAyBC,IAAmB,CACzD,KAAA,CAAE,MAAAC,CAAU,EAAAF,EAEZG,EAAUD,EAAM,IAAI,CAAC,CAAE,KAAAE,CAAK,IAAM,oBAAoBA,EAAK,QAAQ,MAAO,EAAE,KAAK,EAAE,KAAK;AAAA,CAAI,EAE/FC,EAAA,UAAUP,EAAK,KAAKG,EAAQ,UAAU,EAAGE,EAAU;AAAA,EAAOG,GAAQ,CAC7DA,GACA,QAAQ,IAAIA,CAAG,EACf,QAAQ,KAAK,CAAC,GAEd,QAAQ,IAAI;AAAA,CAAwB,CACxC,CACH,CACL,EAEMC,EAAiB,IAAM,CACzB,MAAMC,EAAkBV,EAAK,QAAQ,QAAQ,IAAA,EAAO,cAAc,EAC5DW,EACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAQCJ,EAAG,WAAWG,CAAe,GAC9BH,EAAG,UAAUG,CAAe,EAG7BH,EAAA,UAAUP,EAAK,KAAKU,EAAiB,UAAU,EAAGC,EAAgBH,GAAQ,CACrEA,GACA,QAAQ,IAAIA,CAAG,EACf,QAAQ,KAAK,CAAC,IAEd,QAAQ,IAAI;AAAA,CAAqB,EACjC,QAAQ,KAAK,EACjB,CACH,CACL,EAEaI,EAAW,MAAOC,GAA+B,CAC1D,MAAMC,EAAgBd,EAAK,QAAQ,QAAQ,IAAA,EAAO,qBAAqB,EACjEe,EAAmBf,EAAK,QAAQD,EAAW,kBAAkB,EAE3Dc,EAAA,OAASA,EAAQ,QAAUC,EAC3BD,EAAA,UAAYA,EAAQ,WAAaE,EACjCF,EAAA,KAAOA,EAAQ,MAAQ,SAE3B,GAAA,CACM,MAAAG,EAAiB,MAAMC,cAAY,CACrC,eAAgB,QAChB,eAAgB,GAChB,kBAAmB,GACnB,gBAAiB,EACjB,iBAAkB,GAClB,YAAa,GACb,UAAW,GACX,aAAc,GACd,qBAAsB,GACtB,QAAS,GACT,mBAAoB,GACpB,GAAGJ,CAAA,CACN,EAEaZ,EAAAe,EAAgBH,EAAQ,MAAM,EAC7BJ,UACVS,GACL,QAAQ,MAAMA,CAAC,EACf,QAAQ,KAAK,CAAC,CAClB,CACJ"}